import net.ccbluex.liquidbounce.event.PacketEvent
import net.ccbluex.liquidbounce.features.module.modules.exploit.disablermodes.DisablerMode
import net.minecraft.network.play.client.C03PacketPlayer
import net.minecraft.network.play.server.S08PacketPlayerPosLook

object Matrix : DisablerMode("Matrix") {
    var lastMotionX = 0.0
    var lastMotionY = 0.0
    var lastMotionZ = 0.0
    var pendingFlagApplyPacket = false
    fun onPacket(event: PacketEvent) {
        val packet = event.packet
        if (packet is C03PacketPlayer.C06PacketPlayerPosLook && pendingFlagApplyPacket ) {
            pendingFlagApplyPacket = false
            mc.thePlayer.motionX = lastMotionX
            mc.thePlayer.motionY = lastMotionY
            mc.thePlayer.motionZ = lastMotionZ
        } else if (packet is S08PacketPlayerPosLook) {
            pendingFlagApplyPacket = true
            lastMotionX = mc.thePlayer.motionX
            lastMotionY = mc.thePlayer.motionY
            lastMotionZ = mc.thePlayer.motionZ
    }
}}